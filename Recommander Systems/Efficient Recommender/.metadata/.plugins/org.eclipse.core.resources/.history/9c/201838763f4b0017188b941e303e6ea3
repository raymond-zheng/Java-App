import java.util.ArrayList;


public class FourthRatings {
	
	//Write the private helper method named dotProduct, 
	//which has two parameters, a Rater named me and a Rater
	//named r. This method should first translate a rating from
	//the scale 0 to 10 to the scale -5 to 5 and return the dot 
	//product of the ratings of movies that they both rated. 
	//This method will be called by getSimilarities.
	private double dotProduct(Rater me, Rater r){
		double result = 0;
		for(String rated : me.getItemsRated()){
			//for every film that me have rated
			//see whether r has also rated
			if(r.hasRating(rated)){
				//r has also rated
				result += me.getRating(item)
			}
		}
		return result;
	}

	
	private double getAverageByID(String id, int minimalRaters){
		ArrayList<Rater> raters = RaterDatabase.getRaters();
		double count = 0;
		double tRate = 0;
		for(Rater r : raters){
			if(r.hasRating(id)){
				count += 1;
				tRate += r.getRating(id);
			}
		}
		
		if(count >= minimalRaters){
			return (double)(tRate/count);
		}
		
		return (double)0.0;
	}	
	
	public ArrayList<Rating> getAverageRatings(int minimalRaters){
		ArrayList<Rating> result = new ArrayList<Rating>();
		ArrayList<String> movies = MovieDatabase.filterBy(new TrueFilter());
		for(String id : movies){
			if(getAverageByID(id, minimalRaters) > 0){
				Rating rating = new Rating(id,getAverageByID(id, minimalRaters));
				result.add(rating);
			}
		}
		return result;
	}
	
	public ArrayList<Rating>  getAverageRatingsByFilter(int minimalRaters, Filter filterCriteria){
		ArrayList<Rating> result = new ArrayList<Rating>();
		ArrayList<String> movies = MovieDatabase.filterBy(filterCriteria);
		for(String m : movies){
			if(getAverageByID(m,minimalRaters) > 0){
				Rating rating = new Rating(m,getAverageByID(m,minimalRaters));
				result.add(rating);
			}
		}
		return result;	
	}
}
